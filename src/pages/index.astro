---
import BaseLayout from "../layouts/BaseLayout.astro";

// ðŸŸ¢ CONFIG
const DRIVE_ID = "1kT5FYy81tf49MghFeU6MbwdBPgZIoiCB";
const title = "La RÃ©gence â€” Bar-Brasserie Ã  Mont-de-Marsan";
const description =
  "Cuisine maison le midi & le soir, cafÃ©, biÃ¨res, cocktails. Terrasse et salle conviviales au cÅ“ur de Mont-de-Marsan.";

const today = new Date().toISOString().slice(0, 10);
const menuPrimary = `https://drive.google.com/uc?export=view&id=${DRIVE_ID}&v=${today}`;
const menuFallback = `https://drive.google.com/thumbnail?id=${DRIVE_ID}&sz=w1600&v=${today}`;
---
<BaseLayout {title} {description}>
  <!-- SPLASH -->
  <div
    id="splash"
    class="fixed inset-0 z-50 bg-brand text-[var(--color-bg)]
           flex flex-col items-center justify-center gap-5
           transform-gpu translate-y-0 transition-transform duration-[1800ms] ease-out"
  >
    <img src="/logo.png" alt="La RÃ©gence"
         class="w-60 h-60 md:w-72 md:h-72 lg:w-80 lg:h-80 object-contain" />
    <p class="text-2xl md:text-3xl tracking-wide">Bar-Brasserie Ã  Mont-de-Marsan</p>
  </div>

  <!-- Layout principal -->
  <div class="flex min-h-screen">
    <!-- SIDEBAR GAUCHE (20%) : vert de marque + texte beige -->
    <aside
      class="w-[20%] fixed top-0 left-0 h-screen border-r soft-border p-6 flex flex-col gap-6 z-40 bg-brand text-[var(--color-bg)]"
    >
      <a href="/" class="flex items-center gap-3">
        <img src="/logo.png" alt="La RÃ©gence" class="w-12 h-12" />
        <div class="leading-tight">
          <p class="font-bold">La RÃ©gence</p>
          <p class="text-sm opacity-80">Bar-Brasserie</p>
        </div>
      </a>

      <nav class="flex flex-col gap-2 text-[15px]">
        <a href="/menu" class="px-4 py-2 rounded-xl border inline-block border-[var(--color-bg)] text-[var(--color-bg)]
           hover:bg-[var(--color-bg)] hover:text-brand transition">Carte</a>
        <a href="/boissons" class="px-4 py-2 rounded-xl border inline-block border-[var(--color-bg)] text-[var(--color-bg)]
           hover:bg-[var(--color-bg)] hover:text-brand transition">Boisson</a>
        <a href="/la-regence" class="px-4 py-2 rounded-xl border inline-block border-[var(--color-bg)] text-[var(--color-bg)]
           hover:bg-[var(--color-bg)] hover:text-brand transition">La RÃ©gence</a>
        <a href="/contact" class="px-4 py-2 rounded-xl border inline-block border-[var(--color-bg)] text-[var(--color-bg)]
           hover:bg-[var(--color-bg)] hover:text-brand transition">Contact</a>
      </nav>

      <div class="mt-auto">
        <p class="text-xs uppercase tracking-wide opacity-80 mb-2">Suivez-nous</p>
        <div class="flex items-center gap-4">
          <a href="#" aria-label="Instagram" class="hover:opacity-80" title="Instagram">
            <!-- IcÃ´ne IG -->
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 fill-current" viewBox="0 0 24 24"><path d="M12 2.2c3.2 0 3.6 0 4.9.1 1.2.1 1.9.2 2.4.4.6.2 1 .4 1.4.8s.6.8.8 1.4c.2.5.3 1.2.4 2.4.1 1.3.1 1.7.1 4.9s0 3.6-.1 4.9c-.1 1.2-.2 1.9-.4 2.4-.2.6-.4 1-.8 1.4s-.8.6-1.4.8c-.5.2-1.2.3-2.4.4-1.3.1-1.7.1-4.9.1s-3.6 0-4.9-.1c-1.2-.1-1.9-.2-2.4-.4a3.7 3.7 0 0 1-2.2-2.2c-.2-.5-.3-1.2-.4-2.4C2.2 15.6 2.2 15.2 2.2 12s0-3.6.1-4.9c.1-1.2.2-1.9.4-2.4.2-.6.4-1 .8-1.4s.8-.6 1.4-.8c.5-.2 1.2-.3 2.4-.4C8.4 2.2 8.8 2.2 12 2.2Zm0 1.8c-3.1 0-3.5 0-4.8.1-1 0-1.6.2-1.9.3-.5.2-.8.4-1.2.8s-.6.7-.8 1.2c-.1.3-.3.9-.3 1.9-.1 1.3-.1 1.7-.1 4.8s0 3.5.1 4.8c0 1 .2 1.6.3 1.9.2.5.4.8.8 1.2s.7.6 1.2.8c.3.1.9.3 1.9.3 1.3.1 1.7.1 4.8.1s3.5 0 4.8-.1c1 0 1.6-.2 1.9-.3.5-.2.8-.4 1.2-.8s.6-.7.8-1.2c.1-.3.3-.9.3-1.9.1-1.3.1-1.7.1-4.8s0-3.5-.1-4.8c0-1-.2-1.6-.3-1.9a3 3 0 0 0-.8-1.2c-.4-.4-.7-.6-1.2-.8-.3-.1-.9-.3-1.9-.3-1.3-.1-1.7-.1-4.8-.1Zm0 3.2a6.8 6.8 0 1 1 0 13.6 6.8 6.8 0 0 1 0-13.6Zm0 1.8a5 5 0 1 0 0 10 5 5 0 0 0 0-10Zm5-2.1a1.2 1.2 0 1 1 0 2.4 1.2 1.2 0 0 1 0-2.4Z"/></svg>
          </a>
          <a href="#" aria-label="Facebook" class="hover:opacity-80" title="Facebook">
            <!-- IcÃ´ne FB -->
            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 fill-current" viewBox="0 0 24 24"><path d="M22 12.06C22 6.5 17.52 2 12 2S2 6.5 2 12.06c0 5 3.66 9.12 8.44 9.94v-7.03H7.9V12H10.5v-2.3c0-2.56 1.52-3.98 3.85-3.98 1.12 0 2.3.2 2.3.2v2.54h-1.29c-1.27 0-1.67.79-1.67 1.6V12h2.84l-.45 2.97h-2.4v7.03C18.34 21.18 22 17.06 22 12.06Z"/></svg>
          </a>
        </div>
      </div>
    </aside>

    <!-- CONTENU DROITE (80%) -->
    <main class="ml-[20%] w-[80%] p-6">
      <div class="grid md:grid-cols-2 gap-6 items-start">
        <div class="space-y-4">
          <h1 class="text-3xl font-extrabold text-brand">Bienvenue Ã  La RÃ©gence</h1>
          <p class="text-slate-700">
            Cuisine maison, produits frais. Service le midi en semaine et le soir du lundi au samedi.
            Bar, cafÃ©, cocktails et vins â€” ambiance conviviale en plein centre-ville.
          </p>
          <div class="flex gap-3">
            <a href="/menu" class="btn btn-primary">Voir la carte</a>
            <a href="/contact" class="btn btn-outline">Contact</a>
          </div>
        </div>

        <div class="grid gap-4">
          <div class="rounded-2xl soft-border overflow-hidden">
            <img
              id="heroDynamic"
              src="/bar.jpg"
              alt="La RÃ©gence â€” visuel"
              class="w-full h-64 md:h-80 object-cover"
              data-primary={menuPrimary}
              data-fallback={menuFallback}
            />
          </div>
          <div class="rounded-2xl soft-border overflow-hidden">
            <img src="/bar-small.jpg" alt="La RÃ©gence â€” intÃ©rieur" class="w-full h-40 object-cover" />
          </div>
        </div>
      </div>
    </main>
  </div>

  <!-- Scripts -->
  <script is:inline>
    // Splash : slide up aprÃ¨s 3s (1.8s d'anim)
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    function startSplashExit(){
      const s=document.getElementById('splash');
      if(!s) return;
      if(prefersReduced){ s.remove(); return; }
      s.classList.add('-translate-y-full');
      s.addEventListener('transitionend',()=>s.remove(),{once:true});
    }
    window.addEventListener('load',()=>{ setTimeout(()=>{ requestAnimationFrame(startSplashExit); },3000); });

    // Image dynamique (10â€“15h Europe/Paris â†’ menu, sinon bar.jpg) + ?showMenu=1
    (() => {
      const img = document.getElementById('heroDynamic');
      if (!img) return;

      const params = new URLSearchParams(location.search);
      const forceMenu = params.get('showMenu') === '1';

      const now = new Date();
      const hh = Number(new Intl.DateTimeFormat('fr-FR', {
        hour: '2-digit', hour12: false, timeZone: 'Europe/Paris'
      }).format(now));

      if (forceMenu || (hh >= 10 && hh < 15)) {
        const primary = img.dataset.primary;
        const fallback = img.dataset.fallback;
        const test = new Image();
        test.onload = () => { img.src = primary };
        test.onerror = () => { img.src = fallback };
        test.src = primary;
      }
    })();
  </script>
</BaseLayout>

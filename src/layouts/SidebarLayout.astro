---
import "../styles/global.css";
const { title = "La Régence", description = "" } = Astro.props;
---

<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{title}</title>
    <meta name="description" content={description} />
  </head>

  <body class="min-h-screen text-slate-900 overflow-x-hidden">
    <!-- ===== HEADER MOBILE (bandeau translucide) ===== -->
    <header class="md:hidden fixed inset-x-0 top-0 z-40">
      <div class="h-14 flex items-center justify-between px-4 backdrop-blur bg-black/10">
        <!-- Burger -->
        <button id="mb-open" aria-label="Ouvrir le menu" class="p-2 rounded-md text-brand/90 active:scale-95">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path stroke-linecap="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
        <!-- Logo -->
        <a href="/" aria-label="Accueil" class="inline-flex items-center">
          <img src="/logo.png" alt="La Régence" class="h-8 w-auto"/>
        </a>
      </div>
    </header>

    <!-- ===== DRAWER MOBILE (plein écran, slide gauche) ===== -->
    <div id="mb-drawer" class="md:hidden fixed inset-0 z-50 hidden">
      <!-- Backdrop -->
      <div id="mb-backdrop" class="absolute inset-0 bg-black/50 opacity-0 transition-opacity duration-300"></div>

      <!-- Panneau -->
      <aside id="mb-panel"
             class="relative h-full w-full bg-brand text-[var(--color-bg)]
                    translate-x-[-100%] transition-transform duration-300 ease-out
                    flex flex-col justify-between">
        <!-- Barre haute -->
        <div class="h-14 flex items-center justify-between px-4">
          <button id="mb-close" aria-label="Fermer le menu" class="p-2 rounded-md text-[var(--color-bg)] active:scale-95">
            <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor">
              <path stroke-linecap="round" stroke-width="2" d="M6 6l12 12M18 6l-12 12"/>
            </svg>
          </button>
          <a href="/" aria-label="Accueil">
            <img src="/logo.png" alt="La Régence" class="h-8 w-auto"/>
          </a>
        </div>

        <!-- Contenu drawer (reprend ta sidebar) -->
        <div class="px-6 pt-4 pb-8 overflow-y-auto">
          <div class="flex justify-center mb-6">
            <img src="/logo.png" alt="La Régence" class="w-[220px] max-w-full"/>
          </div>

          <nav class="mt-4">
            <ul class="space-y-6 text-3xl uppercase text-center">
              <li><a href="/menu" class="block hover:text-[var(--color-copper)]">Carte</a></li>
              <li><a href="/boissons" class="block hover:text-[var(--color-copper)]">Boissons</a></li>
              <li><a href="/la-regence" class="block hover:text-[var(--color-copper)]">La Régence</a></li>
              <li><a href="/contact" class="block hover:text-[var(--color-copper)]">Contact</a></li>
            </ul>
          </nav>

          <div class="h-[3px] w-4/5 bg-[var(--color-copper)] mx-auto my-8"></div>
          <div class="flex items-center justify-center gap-6">
            <a href="https://www.instagram.com/la_regence_mdm/" target="_blank" rel="noopener"
               aria-label="Instagram"
               class="inline-flex text-[var(--color-bg)] hover:text-[var(--color-copper)] transition-transform hover:scale-110">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="5"></rect>
                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                <circle cx="17.5" cy="6.5" r="1"></circle>
              </svg>
            </a>
            <a href="https://www.facebook.com/LaRegenceMDM/" target="_blank" rel="noopener"
               aria-label="Facebook"
               class="inline-flex text-[var(--color-bg)] hover:text-[var(--color-copper)] transition-transform hover:scale-110">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" viewBox="0 0 24 24" fill="currentColor">
                <path d="M22 12.06C22 6.49 17.52 2 12 2S2 6.49 2 12.06c0 5.01 3.66 9.16 8.44 9.94v-7.03H7.9v-2.91h2.54V9.41c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.24.2 2.24.2v2.46h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.91h-2.34V22c4.78-.78 8.44-4.93 8.44-9.94z"/>
              </svg>
            </a>
          </div>
        </div>

        <div>
          <div class="w-full h-[3px] bg-[var(--color-copper)]"></div>
          <div class="flex flex-col items-center py-3 opacity-90 text-sm">
            <img src="/logo.png" alt="La Régence" class="w-6 h-6 mb-1 opacity-90" />
            <p>© La Régence 2025</p>
          </div>
        </div>
      </aside>
    </div>

    <!-- ===== WRAPPER DESKTOP : grille 2 colonnes ===== -->
    <div class="md:grid md:grid-cols-[minmax(280px,22vw)_1fr]">
      <!-- Sidebar desktop FIXE (sticky) -->
      <aside class="hidden md:flex bg-brand text-[var(--color-bg)] md:sticky md:top-0 md:h-dvh md:overflow-y-auto
                     flex-col justify-between">
        <div class="flex flex-col items-center mt-6 space-y-6 px-4">
          <a href="/" aria-label="Accueil">
            <img src="/logo.png" alt="La Régence" class="w-[250px] max-w-full mx-auto cursor-pointer" />
          </a>

          <nav class="flex flex-col items-center mt-6">
            <ul class="space-y-5 text-2xl uppercase text-center">
              <li><a href="/menu" class="hover:text-[var(--color-copper)]">Carte</a></li>
              <li><a href="/boissons" class="hover:text-[var(--color-copper)]">Boissons</a></li>
              <li><a href="/la-regence" class="hover:text-[var(--color-copper)]">La Régence</a></li>
              <li><a href="/contact" class="hover:text-[var(--color-copper)]">Contact</a></li>
            </ul>
          </nav>

          <div class="h-[3px] w-4/5 bg-[var(--color-copper)] my-6"></div>
          <div class="flex justify-center gap-6">
            <a href="https://www.instagram.com/la_regence_mdm/" target="_blank" rel="noopener"
               aria-label="Instagram"
               class="inline-flex text-[var(--color-bg)] hover:text-[var(--color-copper)] transition-transform hover:scale-110">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="5"></rect>
                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path>
                <circle cx="17.5" cy="6.5" r="1"></circle>
              </svg>
            </a>
            <a href="https://www.facebook.com/LaRegenceMDM/" target="_blank" rel="noopener"
               aria-label="Facebook"
               class="inline-flex text-[var(--color-bg)] hover:text-[var(--color-copper)] transition-transform hover:scale-110">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10" viewBox="0 0 24 24" fill="currentColor">
                <path d="M22 12.06C22 6.49 17.52 2 12 2S2 6.49 2 12.06c0 5.01 3.66 9.16 8.44 9.94v-7.03H7.9v-2.91h2.54V9.41c0-2.5 1.49-3.88 3.77-3.88 1.09 0 2.24.2 2.24.2v2.46h-1.26c-1.24 0-1.63.77-1.63 1.56v1.87h2.78l-.44 2.91h-2.34V22c4.78-.78 8.44-4.93 8.44-9.94z"/>
              </svg>
            </a>
          </div>
        </div>

        <div>
          <div class="w-full h-[3px] bg-[var(--color-copper)]"></div>
          <div class="flex flex-col items-center py-3 opacity-90 text-sm">
            <img src="/logo.png" alt="La Régence" class="w-6 h-6 mb-1 opacity-90" />
            <p>© La Régence 2025</p>
          </div>
        </div>
      </aside>

      <!-- Contenu (colonne droite) -->
      <main class="bg-main min-h-screen px-4 sm:px-6 md:px-8 pt-16 md:pt-0">
        <!-- pt-16 = place pour le header mobile -->
        <slot />
      </main>
    </div>

    <!-- ===== Scripts : drawer mobile ===== -->
    <script is:inline>
      (function () {
        const openBtn  = document.getElementById('mb-open');
        const closeBtn = document.getElementById('mb-close');
        const drawer   = document.getElementById('mb-drawer');
        const backdrop = document.getElementById('mb-backdrop');
        const panel    = document.getElementById('mb-panel');
        if (!openBtn || !closeBtn || !drawer || !backdrop || !panel) return;

        function openDrawer() {
          drawer.classList.remove('hidden');
          requestAnimationFrame(() => {
            backdrop.classList.add('opacity-100');
            panel.classList.remove('translate-x-[-100%]');
            panel.classList.add('translate-x-0');
            document.body.style.overflow = 'hidden';
          });
        }
        function closeDrawer() {
          backdrop.classList.remove('opacity-100');
          panel.classList.add('translate-x-[-100%]');
          panel.classList.remove('translate-x-0');
          setTimeout(() => {
            drawer.classList.add('hidden');
            document.body.style.overflow = '';
          }, 300);
        }

        openBtn.addEventListener('click', openDrawer);
        closeBtn.addEventListener('click', closeDrawer);
        backdrop.addEventListener('click', closeDrawer);
        drawer.querySelectorAll('a').forEach(a => a.addEventListener('click', closeDrawer));
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && !drawer.classList.contains('hidden')) closeDrawer();
        });
      })();
    </script>
  </body>
</html>
